import { IsDateString, IsEnum, IsNumber, IsOptional, IsString } from 'class-validator';

enum Severity {
  critical = 'critical',
  high = 'high',
  medium = 'medium',
  low = 'low',
}

export class CreateVulnerabilityDto {
  @IsString()
  title: string;

  @IsEnum(Severity)
  severity: Severity;

  @IsOptional()
  @IsString()
  description?: string;

  @IsOptional()
  @IsString()
  status?: string;

  @IsOptional()
  @IsDateString()
  detectedAt?: string;

  @IsOptional()
  @IsString()
  tool?: string;

  @IsOptional()
  @IsString()
  type?: string;

  @IsOptional()
  @IsString()
  cwe?: string;

  @IsOptional()
  @IsString()
  owasp?: string;

  @IsOptional()
  @IsString()
  owaspApi?: string;

  @IsOptional()
  @IsNumber()
  cvss?: number;

  @IsOptional()
  @IsString()
  applicationId?: string;

  @IsOptional()
  @IsString()
  responsibleId?: string;
}
